#! clean build -dtOg 0 -W 9 -p @,test_*

name: phare
self: diagnostic pyphare
scm: https://github.com/dekken/phare
version: rm_code

profile:
- name: init
  inc: src subprojects
  src: src/initializer/(.*_provider.*).cpp
  dep: lang.pybind11 mkn.kul
  mod: lang.python3
  out: phare_initializer

- name: core
  self: init
  src: src/core
  out: phare_core

- name: samrai
  self: core
  src: src/amr
  dep: llnl.samrai(https://github.com/dekken/llnl.samrai)
  out: phare_amr

- name: solver
  self: samrai
  src: src/solver
  out: phare_solver

- name: pyphare
  self: samrai
  src: src/initializer/pyphare.cpp
  out: pyphare
  install: build/src/initializer
  mod: lang.python3 lang.pybind11

- name: simulator
  self: solver
  src: src/simulator
  out: phare_simulator
  mod: lang.python3

- name: diagnostic
  self: simulator
  dep: hpc.highfive(https://github.com/dekken/hpc.highfive)
  inc: /usr/include/hdf5/mpich
  out: phare_diagnostic
  lib: hdf5_mpich

- name: test
  self: diagnostic
  inc: . /usr/include/hdf5/mpich
  dep: google.test hpc.highfive(https://github.com/dekken/hpc.highfive)
  link: -pthread
  mod: lang.python3

- name: test_messengers
  parent: test
  main: tests/amr/messengers/test_messengers.cpp
  env: PYTHONPATH=${MKN_ROOT}/build:${MKN_ROOT}/build/tests/amr/messengers:${MKN_ROOT}/src/phare:${MKN_ROOT}

- name: test_periodicity
  parent: test
  main: tests/amr/periodicity/test_main.cpp
  env: PYTHONPATH=${MKN_ROOT}/build:${MKN_ROOT}/build/tests/amr/periodicity:${MKN_ROOT}/src/phare:${MKN_ROOT}

- name: test_diagnostics
  parent: test
  main: tests/diagnostic/test_main.cpp
  env: PYTHONPATH=${MKN_ROOT}/build:${MKN_ROOT}/build/tests/diagnostic:${MKN_ROOT}/src/phare:${MKN_ROOT}

